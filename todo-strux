Rencana Sprint & Backlog Penugasan - GSS Ticketing & Monev System

Referensi Dokumen: SRS GSS 3.pdf

Total Sprint: 4 Minggu (Target MVP)

Tech Stack Utama: Laravel (Backend/Web), MySQL, n8n (Automation), WhatsApp API, Telegram Bot API.

ğŸ—“ï¸ SPRINT 1: Fondasi Sistem & Manajemen Data Master

Fokus: Setup infrastruktur, Database awal, Manajemen User, dan Integrasi dasar WhatsApp untuk registrasi.

1. Backend & Database (Laravel)
   TODO
   [x] Setup Project: Inisialisasi Project Laravel, Setup Git Repository, Config .env.
   [x] DB Schema: Membuat Migration untuk tabel users, user_roles, dan customers (Sesuai Bab 3.1).
   [x] Auth System: Implementasi Login/Logout dengan Role (Admin/CS, TS, Sales).
   [x] API Endpoint: Membuat API untuk menerima webhook dari n8n (Registrasi Customer).
   [x] CRUD User (MDM-003): - [x] Fungsi Create User (TS/CS) dengan password hashing.
   [x] Fungsi Edit & Non-aktifkan User.

2. Frontend (Web Dashboard)

[x] Layouting: Setup Template Dashboard (Sidebar, Header, Footer).
[x] Page Login: Halaman login responsive.
[x] Page User Management: Grid/List view user & Form tambah user.
[x] Page Customer Management (MDM-002):
[x] Form input manual Customer.
[x] List view data Customer (Filter & Search).

3. Automation (n8n & WA)

[ ] MDM-001 (Registrasi Auto):
[ ] Setup n8n Webhook untuk menerima pesan masuk WA.
[ ] Logic validasi format pesan (Nama#NoHP#Alamat).
[ ] Integrasi simpan data ke Database via API Laravel.
[ ] Reply otomatis WA (Sukses/Gagal).

ğŸ—“ï¸ SPRINT 2: Ticketing Core & FCFS Allocation

Fokus: Pembuatan tiket, Logika "Rebutan" (Bidding/FCFS), dan Integrasi Notifikasi Telegram.

1. Backend & Database

[x] DB Schema: Migration tabel visit_tickets dan visit_assignments.
[x] Ticket Logic (PJV-001):
[x] Fungsi pengecekan kuota ketersediaan TS.
[x] Create Ticket logic.
[x] FCFS Logic (PJV-002) - CRITICAL:
[x] Implementasi DB Transaction Locking (lockForUpdate) untuk mencegah race condition saat TS mengambil job.
[x] Logic validasi: Satu TS tidak boleh ambil job di jam yang bentrok.

2. Frontend (CS & TS View)

[x] Page Create Ticket: Form untuk CS memilih Customer & set Kuota.
[x] Dashboard TS (Mobile View):
[x] Tab "Open Pool" (Job tersedia).
[x] Tab "My Jobs" (Job yang sudah diambil).
[x] Tombol "Ambil Job" dengan handling error jika kalah cepat.

3. Automation (Telegram Bot)

[ ] Bot Setup: Register BotFather, ambil Token, set Webhook.
[ ] Notifikasi Broadcast:
[ ] Trigger n8n saat Tiket dibuat -> Kirim pesan ke Group Telegram TS.
[ ] Trigger saat Job diambil -> Update pesan di Telegram (opsional) atau notif ke CS.

ğŸ—“ï¸ SPRINT 3: Eksekusi Visitasi & Emergency Handling

Fokus: Aktivitas lapangan TS, GPS, Upload Dokumen, dan Logika Darurat.

1. Backend & Database

[x] DB Schema: Migration tabel visit_documents dan visit_attendances.
[x] Attendance Logic (EKD-001):
[x] API Check-in (Capture Timestamp & Geo-location).
[x] API Check-out.
[ ] API Request Extension (Tambah Hari).
[x] Document Logic (PJV-003):
[x] Upload Handler (Surat Tugas, BAST, Foto Bukti).
[x] Storage setup (Local/S3/MinIO).
[x] Emergency Logic (EKD-002):
[x] Scheduled Task (Cron Job) untuk cek tiket yang belum ada Check-in saat jam kunjungan tiba.

2. Frontend (Web App)

[x] Page Visit Detail (TS View):
[x] Tombol Check-in/Check-out (Hanya aktif sesuai status).
[x] Upload Form untuk BAST (PDF/Image).
[x] Download button untuk Surat Tugas.
[x] Dashboard Monitoring (CS View):
[x] Indikator status TS (On-site, Completed, Late).
[x] Alert Emergency jika ada keterlambatan.

3.  Automation

[x] Alert Emergency: Kirim notifikasi "ACTION REQUIRED" ke Telegram CS jika Cron Job mendeteksi keterlambatan check-in.

ğŸ—“ï¸ SPRINT 4: Invoicing, Rating & Finalisasi

Fokus: Alur Penagihan, Feedback Customer, UAT, dan Deployment.

1. Backend & Database

[x] DB Schema: Migration tabel invoices dan customer_feedback.
[x] Invoicing (FIN-001):
[x] Generate Invoice ID (INV-YYYYMM-XXX).
[x] Kalkulasi Total (Base Price - Discount).
[x] Update Status Payment.
[x] Feedback Logic (FDB-001):
[x] API untuk menerima input rating dari form eksternal/n8n.
[x] Trigger update status tiket ke "CLOSED" setelah lunas/rating masuk.

2. Frontend

[x] Page Invoicing (CS): Form input nominal & diskon, pilih Sales untuk approval.
[x] Sales View: Halaman simple untuk Approve/Reject harga (bisa juga via Telegram WebApp jika memungkinkan, tapi MVP Web dulu).
[x] Report Dashboard: Rekap rating rata-rata TS.

3. Automation (n8n)

[x] Sales Approval: Notif ke Telegram Sales saat Draft Invoice dibuat.
[x] Kirim Invoice: Kirim PDF/Link Invoice ke WA Customer setelah Approved.
[x] Rating Loop:
[x] Trigger saat tiket "COMPLETED".
[x] Kirim Link Rating ke WA Customer.
[x] Terima webhook input rating -> Simpan ke DB.

4. Deployment & Testing

[ ] UAT (User Acceptance Testing): Simulasi full cycle dari Chat WA masuk sampai Rating.
[ ] Server Setup: Deploy ke Cloud (VPS/Hosting), Setup Domain/SSL.
[ ] Training: Sesi demo ke CS dan TS.

<!-- CONTROLLERS -->

1. Authentication & User Management (Sprint 1)

    - AuthController (Existing/Modified): Handling Login, Logout, and Reset Password.
    - UserController: CRUD for internal users (Admin, CS, TS, Sales).
      ProfileController (Existing): For users to update their own profile/password.

2. Master Data Management (Sprint 1)

    - CustomerController: CRUD for Customer data, view history, and manual input.
    - WebhookController: Specifically to handle incoming data from n8n (e.g., Auto-registration from WhatsApp).

3. Ticketing Core (Sprint 2)

    - TicketController:
      CS: Create & Edit Tickets.
      All: View Ticket details & status.
    - AssignmentController:
      Critical: Handles the "Rebutan" (FCFS) logic.
      TS: takeJob(), listOpenJobs(), listMyJobs().
    - DashboardController:
      To handle the logic of displaying different stats/views based on the logged-in user's role (Admin vs CS vs TS).

4. Field Operations (Sprint 3)

    - AttendanceController:
      TS: Check-in (Geo-tagging), Check-out.
      CS: Monitor TS status.
    - DocumentController:
      Handle uploads for BAST, Evidence Photos, and generating/downloading Surat Tugas.
    - EmergencyController (Optional/Merged):
      Could be a separate controller if the logic for "Emergency Handling" is complex, or part of AttendanceController.

5. Finance & Feedback (Sprint 4)
    - InvoiceController:
      CS: Create Draft Invoice.
      Sales: Approve/Reject Invoice.
      System: Generate PDF/View Invoice.
    - FeedbackController:
      Handle input ratings from Customers (via Webhook or Form).
    - ReportController:
      Recap TS performance (Ratings, On-time performance).

app/Http/Controllers/
â”œâ”€â”€ Auth/
â”‚ â””â”€â”€ AuthController.php
â”œâ”€â”€ Admin/
â”‚ â”œâ”€â”€ UserController.php
â”‚ â””â”€â”€ ReportController.php
â”œâ”€â”€ Operational/
â”‚ â”œâ”€â”€ TicketController.php
â”‚ â”œâ”€â”€ AssignmentController.php
â”‚ â”œâ”€â”€ AttendanceController.php
â”‚ â””â”€â”€ DocumentController.php
â”œâ”€â”€ Master/
â”‚ â””â”€â”€ CustomerController.php
â”œâ”€â”€ Finance/
â”‚ â””â”€â”€ InvoiceController.php
â”œâ”€â”€ Api/
â”‚ â”œâ”€â”€ WebhookController.php (For n8n)
â”‚ â””â”€â”€ FeedbackController.php (If feedback is via public API)
â””â”€â”€ DashboardController.php

## ğŸ“ Pending Tasks Summary (Auto-Generated 2024-12-12)

### ğŸ“Œ From Project Roadmap (todo-strux):

**Sprint 1: Automation**

-   [ ] **MDM-001 (Registrasi Auto)**: Setup n8n Webhook, Logic Validasi, Integrasi DB, Reply WA.

**Sprint 2: Telegram Bot**

-   [ ] **Bot Setup**: Register BotFather, Token, Webhook.
-   [x] **Notifikasi Broadcast**: Trigger n8n saat Tiket dibuat & saat Job diambil.

**Sprint 3: Field Ops**

-   [x] **API Request Extension**: Endpoint untuk request tambah hari kunjungan.

**Sprint 4: Deployment & Finalization**

-   [ ] **UAT**: Simulasi full cycle dari WA sampai Rating.
-   [ ] **Server Setup**: Deploy ke Cloud (VPS/Hosting), Domain/SSL.
-   [ ] **Training**: Sesi demo ke user.

### ğŸ’» Codebase Technical Debt (TODOs):

-   [x] **InvoiceController.php**: Implement `index` method (List invoices).
-   [x] **TicketController.php**: Implement `index` method (List tickets logic based on role).
